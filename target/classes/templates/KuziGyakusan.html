<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">  
<head>
    <meta charset="UTF-8">
    
    <title>一番くじ期待値計算</title> 
    
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
    <h1>購入枚数ごとの期待値</h1>
    <p>
        <a href="https://1kuji.com/products" target="_blank" rel="noopener noreferrer">
            一番くじのラインナップを見る（公式サイト）
        </a><br><br>
        <a href="/kuzi"> 購入枚数から期待値を計算したい方はこちら</a>
    </p>
    
    <img src="/images/slot.gif" alt="アニメーション" />
    
    <form action="/KuziGyakusan" method="post">
        残りくじ総数: <input name="total" type="number" th:value="${total}"><br>
        当たり枚数: <input name="atari" type="number" th:value="${atari}"><br>
        小数点以下の計算桁数: <input name="Digits" type="number" th:value="${Digits}"><br>
        <button type="submit">計算する</button>
    </form>
    
    <div th:if="${error}" style="color: red; margin-bottom: 10px;">
        <p th:text="${error}"></p>
    </div>

    <div th:if="${KeyProbs != null}">
        <h2>主要な期待値</h2>
        <table class="center-table" border="1">
            <thead>
            <tr>
            <th>購入数</th>
            <th>あたりが一つ以上出る確率</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="entry : ${KeyProbs}">
                    <td th:text="${entry.key + '枚'}">n</td>
                    <td th:attr="data-raw=${entry.value}" th:text="${#numbers.formatDecimal(entry.value, 1, Digits) + '%'}">確率</td>
            </tr>
            </tbody>
        </table>
        <details>
        <summary style="cursor: pointer; font-weight: bold; padding: 5px;">
            各購入数における詳細な確率を表示
        </summary>
        <p>
            <table class="center-table" border="1">
                <thead>
                <tr>
                <th>購入数</th>
                <th>あたりが一つ以上出る確率</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="entry : ${Probs}">
                    <td th:text="${entry.key + '枚'}">n</td>
                    <td th:attr="data-raw=${entry.value}" th:text="${#numbers.formatDecimal(entry.value, 1, Digits) + '%'}">確率</td>
                </tr>
                </tbody>
            </table>
        </p>
        </details>
    </div>
</body>
</html>